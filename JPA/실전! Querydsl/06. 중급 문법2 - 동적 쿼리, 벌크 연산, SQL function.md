# ğŸ’¡ ë™ì  ì¿¼ë¦¬
- ì˜ˆì „ ìˆœìˆ˜ JPAì—ì„œ ë™ì  ì¿¼ë¦¬ë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ 3ê°€ì§€ê°€ ìˆë‹¤ê³  í–ˆë‹¤.
1. ë¬¸ìì—´ ì¡°í•© â†’ ì¡°ê±´ì— ë”°ë¼ ë¬¸ìì—´ì„ ê²°í•©í•˜ë©´ì„œ queryë¬¸ì„ ë§Œë“¤ê³  parameterë¥¼ ì„¸íŒ…í•´ì£¼ëŠ” ë°©ë²•
2. JPA Criteria â†’ JPA í‘œì¤€ ìŠ¤í™ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥. 
3. queryDSL â†’ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ í†µí•´ ì œê³µë˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ ì¿¼ë¦¬êµ¬í˜„ì„ methodë¡œ í•œë‹¤.
- ì—¬ê¸°ì„œ 3ë²ˆ queryDSLì„ ì‚¬ìš©í•´ì„œ ë™ì  ì¿¼ë¦¬ë¥¼ í•´ê²°í•˜ëŠ” ë°©ì‹ì€ ë‘ê°€ì§€ ë°©ì‹ì´ ìˆë‹¤.
1. BooleanBuilder
2. Where ë‹¤ì¤‘ íŒŒë¼ë¯¸í„° ì‚¬ìš©

## ë™ì  ì¿¼ë¦¬ - BooleanBuilder ì‚¬ìš©
```java
@Test
void dynamicQuery_BooleanBuilder() {
    String usernameParam = "member1";
    Integer ageParam = 10;

    List<Member> result = searchMember1(usernameParam, ageParam);
    assertThat(result.size()).isEqualTo(1);
}

private List<Member> searchMember1(String usernameCond, Integer ageCond) {

    BooleanBuilder builder = new BooleanBuilder();
    if (usernameCond != null) {
        builder.and(member.username.eq(usernameCond));
    }
    if (ageCond != null) {
        builder.and(member.age.eq(ageCond));
    }
    return queryFactory
            .selectFrom(member)
            .where(builder)
            .fetch();
}
```
- `BooleanBuilder` ë¥¼ ì‚¬ìš©í•˜ë©´ ê°€ë…ì„±ì´ ì¢‹ì§€ ì•Šê³  ì½”ë“œë¥¼ íŒŒì•…í•˜ëŠ”ë° ì‹œê°„ë„ ì˜¤ë˜ ê±¸ë¦¬ê²Œ ë˜ë©° ì–´ë–¤ ì¿¼ë¦¬ê°€ ë‚˜ê°ˆì§€ ì˜ˆì¸¡ì´ í˜ë“¤ë‹¤.
- ë˜í•œ ì½”ë“œë¥¼ ë³´ë©´ ì¡°ê±´ë¬¸ì„ í†µí•´ null ì²´í¬ë¥¼ í•´ì¤˜ì•¼í•¨ì€ ë¬¼ë¡  and ë©”ì„œë“œë¥¼ í†µí•´ ì¡°ê±´ì„ í•˜ë‚˜í•˜ë‚˜ ì¶”ê°€í•´ì¤˜ì•¼ í•œë‹¤.

## ë™ì  ì¿¼ë¦¬ - Where ë‹¤ì¤‘ íŒŒë¼ë¯¸í„° ì‚¬ìš©
```java
@Test
void dynamicQuery_WhereParam() {
    String usernameParam = "member1";
    Integer ageParam = 10;

    List<Member> result = searchMember2(usernameParam, ageParam);
    assertThat(result.size()).isEqualTo(1);
}

private List<Member> searchMember2(String usernameCond, Integer ageCond) {
    return queryFactory
            .selectFrom(member)
            .where(usernameEq(usernameCond), ageEq(ageCond))
            .fetch();
}

private BooleanExpression usernameEq(String usernameCond) {
    return usernameCond != null ? member.username.eq(usernameCond) : null;
}

private BooleanExpression ageEq(Integer ageCond) {
    return ageCond != null ? member.age.eq(ageCond) : null;
}
```
- `BooleanExpression` ì„ ì‚¬ìš©í•˜ë©´ whereì—ì„œ ë©”ì„œë“œ ì´ë¦„ë§Œìœ¼ë¡œ ì–´ë–¤ ì¡°ê±´ìœ¼ë¡œ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ì¸ì§€ ìœ ì¶”ê°€ ê°€ëŠ¥í•˜ë‹¤.
- ë˜í•œ, nullì„ ë°˜í™˜í•˜ê²Œ ë˜ë©´ Whereì ˆì—ì„œ ì¡°ê±´ì€ ë¬´ì‹œë˜ì–´ ì•ˆì „í•˜ê³ , andì™€ orê°™ì€ ë©”ì„œë“œë“¤ì„ ì´ìš©í•´ BooleanExpressionë“¤ì„ ì¡°í•©í•´ ìƒˆë¡œìš´  BooleanExpressionì„ ë§Œë“¤ ìˆ˜ ìˆì–´ ì¬ì‚¬ìš©ì„±ì´ ë†’ë‹¤.


# ğŸ’¡ ìˆ˜ì •, ì‚­ì œ ë²Œí¬ ì—°ì‚°
```java
 @Test
void bulkUpdate() {
    long count = queryFactory
            .update(member)
            .set(member.username, "ë¹„íšŒì›")
            .where(member.age.lt(28))
            .execute();

    assertThat(count).isEqualTo(2);
}
```
```java
@Test
void bulkAdd() {
    long count = queryFactory
            .update(member)
            .set(member.age, member.age.add(2))
            .execute();

    assertThat(count).isEqualTo(4);
}
```
```java
@Test
void bulkDelete() {
    long count = queryFactory
            .delete(member)
            .where(member.age.gt(18))
            .execute();

    assertThat(count).isEqualTo(3);
}
```
### â— ë²Œí¬ ì—°ì‚° ì‹œ ì£¼ì˜ì 
- JPQL ë°°ì¹˜ì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ì—”í‹°í‹°ë¥¼ ë¬´ì‹œí•˜ê³  ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ë°°ì¹˜ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê³  ë‚˜ë©´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™” í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.
- ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™” í•˜ì§€ ì•Šìœ¼ë©´ DBì˜ ë°ì´í„°ì™€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ì—”í‹°í‹° ë°ì´í„°ê°€ ì¼ì¹˜í•˜ì§€ ì•Šì•„ ë¬¸ì œê°€ ë  ìˆ˜ ìˆë‹¤.

# ğŸ’¡ SQL function í˜¸ì¶œí•˜ê¸°
- SQL functionì€ JPAì™€ ê°™ì´ Dialectì— ë“±ë¡ëœ ë‚´ìš©ë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

```java
// ì‚¬ìš©ì ì´ë¦„ member -> M ìœ¼ë¡œ ë³€ê²½í•˜ëŠ” replace í•¨ìˆ˜ ì‚¬ìš©
@Test
void sqlFunction() {
    List<String> result = queryFactory
            .select(
                    Expressions.stringTemplate("function('replace', {0}, {1}, {2})",
                            member.username, "member", "M")
            )
            .from(member)
            .fetch();
}
```

```java
// ì†Œë¬¸ìë¡œ ë³€ê²½í•˜ëŠ” lower í•¨ìˆ˜ ì‚¬ìš©
@Test
void sqlFunction2() {
    queryFactory
            .select(member.username)
            .from(member)
            .where(member.username.eq(Expressions.stringTemplate("function('lower', {0})", member.username)))
            .fetch();
}
```
- ì°¸ê³ ë¡œ, `lower` ê°™ì€ **ansi í‘œì¤€ í•¨ìˆ˜**ë“¤ì€ querydslì´ ìƒë‹¹ë¶€ë¶„ ë‚´ì¥í•˜ê³  ìˆë‹¤.
- ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬í•´ë„ ê²°ê³¼ëŠ” ê°™ë‹¤.
```java
queryFactory
        .select(member.username)
        .from(member)
        .where(member.username.eq(member.username.lower()))
        .fetch();
```
