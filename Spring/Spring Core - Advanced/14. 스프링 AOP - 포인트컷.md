# π’΅ ν¬μΈνΈμ»· μ§€μ‹μ
- AspectJ λ” ν¬μΈνΈμ»·μ„ νΈλ¦¬ν•κ² ν‘ν„ν•κΈ° μ„ν• ν‘ν„μ‹μ„ μ κ³µν•λ©°, μ¤ν”„λ§λ„ μ΄λ¥Ό μ°¨μ©ν•λ‹¤.
- μ) `@Pointcut("execution(* com.study.advanced.aop.member..*.*(..))")`
- ν¬μΈνΈμ»· ν‘ν„μ‹μ€ exection κ°™μ€ ν¬μΈνΈμ»· μ§€μ‹μλ΅ μ‹μ‘ν•λ‹¤.
- ν¬μΈνΈμ»· μ§€μ‹μλ” execution, within, args λ“±μ΄ μ΅΄μ¬ν•λ”λ°, κ°κ° λ§¤μΉ­μ‹ ν™•μΈν•λ” μ •λ³΄κ°€ λ‹¤λ¥΄λ‹¤.

## exeuction
- κ°€μ¥ μ¤‘μ”ν• ν¬μΈνΈμ»· μ§€μ‹μμ΄λ©°, μ¤ν”„λ§ AOPμ—μ„ κ°€μ¥ λ§μ΄ μ‚¬μ©ν•λ‹¤.
- λ¬Έλ²•μ€ μ•„λμ™€ κ°™λ‹¤.
- `execution(modifiers-pattern? ret-type-pattern declaring-type-pattern?namepattern(param-pattern) throws-pattern?)`
- `execution(μ ‘κ·Όμ μ–΄μ? λ°ν™νƒ€μ… μ„ μ–Ένƒ€μ…?λ©”μ„λ“μ΄λ¦„(νλΌλ―Έν„°) μμ™Έ?)`
- execution μ€ λ©”μ„λ“μ μ ‘κ·Όμ μ–΄μ, λ°ν™νƒ€μ…, μ„ μ–Ένƒ€μ…(ν¨ν‚¤μ§€+ν΄λμ¤), λ©”μ„λ“μ΄λ¦„, νλΌλ―Έν„° λ“±μΌλ΅ λ§¤μΉ­μ„ μν–‰ν•λ‹¤.
- ?λ΅ ν‘μ‹λ μ ‘κ·Όμ μ–΄μ, μ„ μ–Ένƒ€μ…, μμ™Έλ” μƒλµμ΄ κ°€λ¥ν•λ‹¤.
- λ°ν™νƒ€μ…, λ©”μ„λ“μ΄λ¦„, νλΌλ―Έν„°λ” ν•„μμ΄λ‹¤.

### λ©”μ„λ“ μ΄λ¦„ λ§¤μΉ­
```java
// λ©”μ„λ“λ… hello λ§¤μΉ­
@Pointcut("execution(* hello(..))")

// λ©”μ„λ“λ… hel λ΅ μ‹μ‘ λ§¤μΉ­
@Pointcut("execution(* hel*(..))")

// λ©”μ„λ“λ… μ‚¬μ΄ el μμ„μ‹ λ§¤μΉ­
@Pointcut("execution(* *el*(..))")
```
- λ°ν™νƒ€μ…, λ©”μ„λ“ μ΄λ¦„, νλΌλ―Έν„°λ” ν•„μμ΄λ‹¤.
- λ°ν™νƒ€μ…μ€ * λ΅ λ¬΄κ΄€. νλΌλ―Έν„°λ” .. λ΅ κ°μ, νƒ€μ… λ¬΄κ΄€μ΄λ―€λ΅ λ©”μ„λ“ μ΄λ¦„μΌλ΅λ§ λ§¤μΉ­ν•λ‹¤.
- λ©”μ„λ“ μ΄λ¦„ μ•λ’¤μ— *λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

### ν¨ν‚¤μ§€ λ§¤μΉ­
```java
// ν¨ν‚¤μ§€.νƒ€μ….λ©”μ„λ“ μ΄λ¦„ λ§¤μΉ­
@Pointcut("execution(* com.study.advanced.aop.member.MemberService.hello(..))")

// member ν¨ν‚¤μ§€ λ‚΄μ λ¨λ“  λ©”μ„λ“ λ§¤μΉ­
@Pointcut("execution(* com.study.advanced.aop.member.*.*(..))")

// member ν¨ν‚¤μ§€ & ν•μ„ ν¨ν‚¤μ§€μ λ¨λ“ λ©”μ„λ“ λ§¤μΉ­
@Pointcut("execution(* com.study.advanced.aop.member..*.*(..))")
```
- λ©”μ„λ“ μ΄λ¦„ μ•μ— μ„ μ–Ένƒ€μ… λ§¤μΉ­μ„ ν†µν•΄ ν¨ν‚¤μ§€λ… λ§¤μΉ­μ΄ κ°€λ¥ν•λ‹¤.
- .μ„ μ‚¬μ©ν•λ©΄ ν•΄λ‹Ή ν¨ν‚¤μ§€ λ‚΄μ ν΄λμ¤μ™€ λ©”μ„λ“λ§ μ μ©ν•λ‹¤.
- ..μ„ μ‚¬μ©ν•λ©΄ ν•΄λ‹Ήν¨ν‚¤μ§€μ™€ ν•μ„ν¨ν‚¤μ§€λ¥Ό λ¨λ‘ μ μ©ν•λ‹¤.

### νλΌλ―Έν„° λ§¤μΉ­
```java
// νλΌλ―Έν„° 1κ° νƒ€μ… λ§¤μΉ­
@Pointcut("execution(* *(String))")

// νλΌλ―Έν„°X λ§¤μΉ­
@Pointcut("execution(* *())")

// νλΌλ―Έν„° λ¬΄κ΄€ λ§¤μΉ­
@Pointcut("execution(* *(..))")

// μ²«λ²μ§Έ νλΌλ―Έν„° νƒ€μ… λ§¤μΉ­, κ°―μ λ¬΄κ΄€
@Pointcut("execution(* *(String, ..))")
```
- (String) : μ •ν™•ν•κ² String νƒ€μ… νλΌλ―Έν„°
- () : νλΌλ―Έν„°κ°€ μ—†μ–΄μ•Ό ν•λ‹¤.
- (*) : μ •ν™•ν ν•λ‚μ νλΌλ―Έν„°, λ‹¨ λ¨λ“  νƒ€μ…μ„ ν—μ©ν•λ‹¤.
- (*, *) : μ •ν™•ν λ‘ κ°μ νλΌλ―Έν„°, λ‹¨ λ¨λ“  νƒ€μ…μ„ ν—μ©ν•λ‹¤.
- (..) : κ°μμ™€ λ¬΄κ΄€ν•κ² λ¨λ“  νλΌλ―Έν„°, λ¨λ“  νƒ€μ…μ„ ν—μ©ν•λ‹¤. μ°Έκ³ λ΅ νλΌλ―Έν„°κ°€ μ—†μ–΄λ„ λλ‹¤.
- (String, ..) : String νƒ€μ…μΌλ΅ μ‹μ‘ν•΄μ•Ό ν•λ‹¤. κ°―μμ™€ λ¬΄κ΄€ν•κ² λ¨λ“  νλΌλ―Έν„°, λ¨λ“  νƒ€μ…μ„ ν—μ©ν•λ‹¤.

## within
```java
@Pointcut("within(com.study.advanced.aop.member.memberSerivce)")
```
- within μ§€μ‹μλ” νΉμ • νƒ€μ… λ‚΄μ μ΅°μΈ ν¬μΈνΈλ“¤λ΅ λ§¤μΉ­μ„ μ ν•ν•λ‹¤.
- ν•΄λ‹Ή νƒ€μ…μ΄ λ§¤μΉ­λλ©΄ κ·Έ μ•μ λ©”μ„λ“(μ΅°μΈ ν¬μΈνΈ)λ“¤μ΄ μλ™μΌλ΅ λ§¤μΉ­λλ‹¤.
- λ¬Έλ²•μ€ λ‹¨μν•λ° execution μ—μ„ νƒ€μ… λ¶€λ¶„λ§ μ‚¬μ©ν•λ‹¤κ³  λ³΄λ©΄ λλ‹¤.
- execution μ νƒ€μ… λ§¤μΉ­κ³Όλ” λ‹¤λ¥΄κ² λ¶€λ¨νƒ€μ…μ„ μ§€μ •ν•΄λ„ μμ‹ν΄λμ¤λ” λ§¤μΉ­μ΄ λμ§€ μ•λ”λ‹¤. (νƒ€μ…μ΄ μ •ν™•ν•κ² μΌμΉν•΄μ•Ό ν•λ‹¤.)

## args
```java
@Pointcut("args(String, ..)")
```
- args λ” νλΌλ―Έν„°λ΅λ§ λ§¤μΉ­μ„ μν–‰ν•λ‹¤.
- κΈ°λ³Έ λ¬Έλ²•μ€ execution μ νλΌλ―Έν„° λ¶€λ¶„κ³Ό κ°™λ‹¤.
- execution μ νλΌλ―Έν„° λ§¤μΉ­κ³Ό λ‹¤λ¥Έ μ μ€ λ¶€λ¨νƒ€μ…μ„ μ…λ ¥ν•λ©΄ μμ‹νƒ€μ…μ νλΌλ―Έν„°λ„ λ§¤μΉ­λλ‹¤.

## @target, @within
```java
@Pointcut("@target(com.study.advanced.aop.member.annotation.ClassAop)")
```
- @target μ€ νƒ€μ…μ μ• λ…Έν…μ΄μ…μΌλ΅ λ§¤μΉ­μ„ μν–‰ν•λ‹¤.
- μμ μ—μ„ @ClassAop μ• λ…Έν…μ΄μ…μ΄ μ¶”κ°€λ ν΄λμ¤μ λ¨λ“  λ©”μ„λ“λ¥Ό λ§¤μΉ­ν•λ‹¤.
- μ΄λ• μμ‹νƒ€μ…μ— ν•΄λ‹Ή μ• λ…Έν…μ΄μ…μ΄ μ¶”κ°€ λμ–΄ μμΌλ©΄ λ¶€λ¨νƒ€μ…λ„ ν•¨κ» λ§¤μΉ­μ‹ν‚¨λ‹¤.

```java
@Pointcut("@within(com.study.advanced.aop.member.annotation.ClassAop)")
```
- @within λ„ @target μ²λΌ νƒ€μ…μ μ• λ…Έν…μ΄μ…μΌλ΅ λ§¤μΉ­ν•λ‹¤.
- @targetκ³Ό μ°¨μ΄μ μ€ μμ‹νƒ€μ…μ— ν•΄λ‹Ή μ• λ…Έν…μ΄μ…μ΄ μμ–΄λ„ νƒ€μ…μ€ λ§¤μΉ­μ‹ν‚¤μ§€ μ•λ”λ‹¤.
- μ‰½κ² μ΄μ•ΌκΈ°ν•΄μ„ @target μ€ λ¶€λ¨ νƒ€μ…μ λ©”μ„λ“κΉμ§€ μ–΄λ“λ°”μ΄μ¤λ¥Ό λ‹¤ μ μ©ν•κ³ , @within μ€ μκΈ° μμ‹ μ νƒ€μ…μ— μ •μλ λ©”μ„λ“μ—λ§ μ–΄λ“λ°”μ΄μ¤λ¥Ό μ μ©ν•λ‹¤.

![image](https://github.com/shin-je-woo/TIL/assets/39439576/69ca888d-b338-4f78-b948-a08f1ba9f1db)

## @annotation
```java
@Pointcut("@annotation(com.study.advanced.aop.member.annotation.MethodAop)")
```
- @annotation μ€ λ©”μ„λ“μ— ν•΄λ‹Ή μ• λ…Έν…μ΄μ… μλ” κ²½μ° λ§¤μΉ­ν•λ‹¤.

## @args
```java
@Pointcut("@args(com.study.advanced.aop.member.annotation.ParamAop)")
```
- @args λ” λ©”μ„λ“μ νλΌλ―Έν„°μ— ν•΄λ‹Ή μ• λ…Έν…μ΄μ…μ΄ μλ” κ²½μ° λ§¤μΉ­ν•λ‹¤.

## bean
```java
@Pointcut("bean(orderService) || bean(orderRepository)")
```
- bean μ€ μ¤ν”„λ§ μ „μ© ν¬μΈνΈμ»· μ§€μ‹μλ΅μ¨ λΉ μ΄λ¦„μΌλ΅ λ§¤μΉ­μ„ μν–‰ν•λ‹¤.
- ν•΄λ‹Ή λΉμ λ¨λ“  λ©”μ„λ“κ°€ λ§¤μΉ­λλ‹¤.

## this, target
```java
@Pointcut("this(com.study.advanced.aop.member.MemberService)")
@Pointcut("target(com.study.advanced.aop.member.MemberService)")
```
- this λ” μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅λμ–΄ μλ” ν”„λ΅μ‹ κ°μ²΄λ¥Ό λ€μƒμΌλ΅ ν¬μΈνΈμ»·μ„ λ§¤μΉ­ν•λ‹¤.
- target μ€ μ‹¤μ  λ€μƒ κ°μ²΄λ¥Ό λ€μƒμΌλ΅ ν¬μΈνΈμ»·μ„ λ§¤μΉ­ν•λ‹¤.

# π’΅ λ§¤κ°λ³€μ μ „λ‹¬
- λ‹¤μμ€ ν¬μΈνΈμ»· ν‘ν„μ‹μ„ μ‚¬μ©ν•΄μ„ μ–΄λ“λ°”μ΄μ¤μ— λ§¤κ°λ³€μλ¥Ό μ „λ‹¬ν•  μ μλ‹¤.
- args, this, target, @annotation, @args, @target, @within
```java
// args β†’ λ©”μ„λ“μ λ§¤κ°λ³€μλ¥Ό μ „λ‹¬ λ°›λ”λ‹¤.
@Before("allMember() && args(arg, ..)")
public void logArgs2(Object arg)

// args β†’ λ©”μ„λ“μ λ§¤κ°λ³€μλ¥Ό μ „λ‹¬ λ°›λ”λ‹¤. μ¶”κ°€λ΅ νƒ€μ…μ„ String μΌλ΅ μ ν•ν•  μ μλ‹¤.
@Before("allMember() && args(arg, ..)")
public void logArgs3(String arg)

// this β†’ ν”„λ΅μ‹ κ°μ²΄λ¥Ό μ „λ‹¬ λ°›λ”λ‹¤.
@Before("allMember() && this(obj)")
public void thisArgs(JoinPoint joinPoint, MemberService obj)

// target β†’ μ‹¤μ  λ€μƒ κ°μ²΄λ¥Ό μ „λ‹¬ λ°›λ”λ‹¤.
@Before("allMember() && target(obj)")
public void targetArgs(JoinPoint joinPoint, MemberService obj)

// @annotation β†’ λ©”μ„λ“μ μ• λ…Έν…μ΄μ…μ„ μ „λ‹¬ λ°›λ”λ‹¤.
// μ—¬κΈ°μ„λ” annotation.value() λ΅ ν•΄λ‹Ή μ• λ…Έν…μ΄μ…μ κ°’μ„ μ¶λ ¥ν•λ” λ¨μµμ„ ν™•μΈν•  μ μλ‹¤.
@Before("allMember() && @annotation(annotation)")
public void atAnnotation(JoinPoint joinPoint, MethodAop annotation) {
    log.info("[@annotation]{}, annotationValue={}", joinPoint.getSignature(), annotation.value());
}
```
