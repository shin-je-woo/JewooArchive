# π’΅ ν”„λ΅μ‹(Proxy) ν¨ν„΄

ν”„λ΅μ‹ ν¨ν„΄(Proxy Pattern)μ€ λ€μƒ μ›λ³Έ κ°μ²΄λ¥Ό λ€λ¦¬ν•μ—¬ λ€μ‹  μ²λ¦¬ν•κ² ν•¨μΌλ΅μ¨ λ΅μ§μ νλ¦„μ„ μ μ–΄ν•λ” ν–‰λ™ ν¨ν„΄μ΄λ‹¤.

ν”„λ΅μ‹(Proxy)μ μ‚¬μ „μ μΈ μλ―Έλ” 'λ€λ¦¬μΈ'μ΄λΌλ” λ»μ΄λ‹¤. 
μ¦‰, λ„κµ°κ°€μ—κ² μ–΄λ–¤ μΌμ„ λ€μ‹  μ‹ν‚¤λ” κ²ƒμ„ μλ―Έν•λ”λ°, μ΄λ¥Ό κ°μ²΄ μ§€ν–¥ ν”„λ΅κ·Έλλ°μ— μ ‘λ©ν•΄λ³΄λ©΄ ν΄λΌμ΄μ–ΈνΈκ°€ λ€μƒ κ°μ²΄λ¥Ό μ§μ ‘ μ“°λ”κ² μ•„λ‹λΌ μ¤‘κ°„μ— ν”„λ΅μ‹(λ€λ¦¬μΈ)μ„ κ±°μ³μ„ μ“°λ” μ½”λ“ ν¨ν„΄μ΄λΌκ³  λ³΄λ©΄ λλ‹¤. 

λ”°λΌμ„ λ€μƒ κ°μ²΄(Subject)μ λ©”μ†λ“λ¥Ό μ§μ ‘ μ‹¤ν–‰ν•λ” κ²ƒμ΄ μ•„λ‹, λ€μƒ κ°μ²΄μ— μ ‘κ·Όν•κΈ° μ „μ— ν”„λ΅μ‹(Proxy) κ°μ²΄μ λ©”μ„λ“λ¥Ό μ ‘κ·Όν• ν›„ μ¶”κ°€μ μΈ λ΅μ§μ„ μ²λ¦¬ν•λ’¤ μ ‘κ·Όν•κ² λλ‹¤.

![image](https://github.com/user-attachments/assets/5bf45f8d-b45b-4a85-a63a-3c4ad919f78f)

μ΄λ ‡κ² λ€λ¦¬μλ¥Ό ν†µν•΄ μ΄μ©ν•λ” λ°©μ‹μ„ μ·¨ν•λ” μ΄μ λ”, λ€μƒ ν΄λμ¤κ°€ λ―Όκ°ν• μ •λ³΄λ¥Ό κ°€μ§€κ³  μκ±°λ‚ μΈμ¤ν„΄μ¤ν™” ν•κΈ°μ— λ¬΄κ²κ±°λ‚ μ¶”κ°€ κΈ°λ¥μ„ κ°€λ―Έν•κ³  μ‹¶μ€λ°, μ›λ³Έ κ°μ²΄λ¥Ό μμ •ν• μ μ—†λ” μƒν™©μΌ λ•λ¥Ό κ·Ήλ³µν•κΈ° μ„ν•΄μ„μ΄λ‹¤.

λ€λ¦¬μκ°€ μ¤‘κ°„μ—μ„ μ›λ³Έ κ°μ²΄ λ€μ‹  μ—¬λ¬κ°€μ§€ μΌμ„ μν–‰ν•  μ μλ‹¤.

### λ³΄μ•(Security)
- ν”„λ΅μ‹λ” ν΄λΌμ΄μ–ΈνΈκ°€ μ‘μ—…μ„ μν–‰ν•  μ μλ” κ¶ν•μ΄ μλ”μ§€ ν™•μΈν•κ³  κ²€μ‚¬ κ²°κ³Όκ°€ κΈμ •μ μΈ κ²½μ°μ—λ§ μ”μ²­μ„ λ€μƒμΌλ΅ μ „λ‹¬ν•λ‹¤.

### μΊμ‹±(Caching)
- ν”„λ΅μ‹κ°€ λ‚΄λ¶€ μΊμ‹λ¥Ό μ μ§€ν•μ—¬ λ°μ΄ν„°κ°€ μΊμ‹μ— μ•„μ§ μ΅΄μ¬ν•μ§€ μ•λ” κ²½μ°μ—λ§ λ€μƒμ—μ„ μ‘μ—…μ΄ μ‹¤ν–‰λλ„λ΅ ν•λ‹¤.

### λ°μ΄ν„° μ ν¨μ„± κ²€μ‚¬(Data validation)
- ν”„λ΅μ‹κ°€ μ…λ ¥μ„ λ€μƒμΌλ΅ μ „λ‹¬ν•κΈ° μ „μ— μ ν¨μ„±μ„ κ²€μ‚¬ν•λ‹¤.

### μ§€μ—° μ΄κΈ°ν™”(Lazy initialization)
- λ€μƒμ μƒμ„± λΉ„μ©μ΄ λΉ„μ‹Έλ‹¤λ©΄ ν”„λ΅μ‹λ” κ·Έκ²ƒμ„ ν•„μ”λ΅ ν• λ•κΉμ§€ μ—°κΈ°ν•  μ μλ‹¤.

### λ΅κΉ…(Logging)
- ν”„λ΅μ‹λ” λ©”μ†λ“ νΈμ¶κ³Ό μƒλ€ λ§¤κ° λ³€μλ¥Ό μΈν„°μ…‰νΈν•κ³  μ΄λ¥Ό κΈ°λ΅ν•λ‹¤.

### μ›κ²© κ°μ²΄(Remote objects)
- ν”„λ΅μ‹λ” μ›κ²© μ„μΉμ— μλ” κ°μ²΄λ¥Ό κ°€μ Έμ™€μ„ λ΅μ»¬μ²λΌ λ³΄μ΄κ² ν•  μ μλ‹¤.

# π’΅ ν”„λ΅μ‹ ν¨ν„΄ κµ¬μ΅°

ν”„λ΅μ‹λ” λ‹¤λ¥Έ κ°μ²΄μ— λ€ν• μ ‘κ·Όμ„ μ μ–΄ν•λ” κ°μ²΄μ΄λ‹¤. 
μ—¬κΈ°μ„ λ‹¤λ¥Έ κ°μ²΄λ¥Ό λ€μƒ(Subject)λΌκ³  λ¶€λ¥Έλ‹¤. ν”„λ΅μ‹μ™€ λ€μƒμ€ λ™μΌν• μΈν„°νμ΄μ¤λ¥Ό κ°€μ§€κ³  μμΌλ©° μ΄λ¥Ό ν†µν•΄ λ‹¤λ¥Έ μΈν„°νμ΄μ¤μ™€ μ™„μ „ν νΈν™λλ„λ΅ λ°”κΏ€μ μλ‹¤.

![image](https://github.com/user-attachments/assets/d2dd000d-08ef-4e41-913d-0a71dac6e86e)

### Subject
- Proxyμ™€ RealSubjectλ¥Ό ν•λ‚λ΅ λ¬¶λ” μΈν„°νμ΄μ¤ (λ‹¤ν•μ„±)
- λ€μƒ κ°μ²΄μ™€ ν”„λ΅μ‹ μ—­ν• μ„ λ™μΌν•κ² ν•λ” μ¶”μƒ λ©”μ†λ“ operation() λ¥Ό μ •μν•λ‹¤.
- μΈν„°νμ΄μ¤κ°€ μκΈ° λ•λ¬Έμ— ν΄λΌμ΄μ–ΈνΈλ” Proxy μ—­ν• κ³Ό RealSubject μ—­ν• μ μ°¨μ΄λ¥Ό μμ‹ν•  ν•„μ”κ°€ μ—†λ‹¤.

### RealSubject
- μ›λ³Έ λ€μƒ κ°μ²΄

### Proxy
- λ€μƒ κ°μ²΄(RealSubject)λ¥Ό μ¤‘κ³„ν•  λ€λ¦¬μ μ—­ν• 
- ν”„λ΅μ‹λ” λ€μƒ κ°μ²΄λ¥Ό ν•©μ„±(composition)ν•λ‹¤.
- ν”„λ΅μ‹λ” λ€μƒ κ°μ²΄μ™€ κ°™μ€ μ΄λ¦„μ λ©”μ„λ“λ¥Ό νΈμ¶ν•λ©°, λ³„λ„μ λ΅μ§μ„ μν–‰ ν• μ μλ‹¤. (μΈν„°νμ΄μ¤ κµ¬ν„ λ©”μ†λ“)
- ν”„λ΅μ‹λ” νλ¦„μ μ–΄λ§ ν•  λΏ κ²°κ³Όκ°’μ„ μ΅°μ‘ν•κ±°λ‚ λ³€κ²½μ‹ν‚¤λ©΄ μ• λλ‹¤.

### Client 
- Subject μΈν„°νμ΄μ¤λ¥Ό μ΄μ©ν•μ—¬ ν”„λ΅μ‹ κ°μ²΄λ¥Ό μƒμ„±ν•΄ μ΄μ©.
- ν΄λΌμ΄μ–ΈνΈλ” ν”„λ΅μ‹λ¥Ό μ¤‘κ°„μ— λ‘κ³  ν”„λ΅μ‹λ¥Ό ν†µν•΄μ„ RealSubjectμ™€ λ°μ΄ν„°λ¥Ό μ£Όκ³  λ°›λ”λ‹¤.

# π’΅ μμ 

λ€μƒ κ°μ²΄κ°€ κ°’μ„ λ°ν™ν•λ ¤λ©΄ 1μ΄ λ™μ•μ μ‹κ°„μ΄ μ†μ”λλ” μ‘μ—…μ„ μ§„ν–‰ν•λ‹¤κ³  κ°€μ •ν•μ. κ·Έλ¦¬κ³ , λ€μƒ κ°μ²΄λ” λ§¤λ² κ°™μ€ κ°’μ„ λ°ν™ν•λ‹¤.

μ΄ λ•, ν”„λ΅μ‹λ¥Ό λ„μ…ν•μ—¬ λ€μƒ κ°μ²΄μ κ°’μ„ μΊμ‹±ν•μ—¬ μ €μ¥ν•΄λ‘κ³ , ν΄λΌμ΄μ–ΈνΈμ—κ² μ΄λ―Έ μ΅°νλ λ°μ΄ν„°λ¥Ό μ κ³µν•λ©΄ μ„±λ¥ μƒ μ΄μ μ΄ μλ‹¤.

```java
public interface Subject {
    String operation();
}
```

```java
// λ€μƒ κ°μ²΄
public class RealSubject implements Subject {

    @Override
    public String operation() {
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
        return "fixed value";
    }
}
```

```java
// ν”„λ΅μ‹ κ°μ²΄
public class CacheProxy implements Subject {

    private final Subject target;
    private String cacheValue;

    public CacheProxy(Subject target) {
        this.target = target;
    }

    @Override
    public String operation() {
        // λ€μƒ κ°μ²΄μ λ°ν™κ°’μ„ μΊμ‹±ν•΄λ‘”λ‹¤. (μ•„λμ μ½”λ“λ” λ™κΈ°ν™”κ°€ ν•„μ”ν•μ§€λ§ μƒλµ)
        if (cacheValue == null) {
            cacheValue = target.operation();
        }
        // ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹±λ κ°’μ„ λ°ν™λ°›λ”λ‹¤.
        return cacheValue;
    }
}
```

```java
public class Client {

    public static void main(String[] args) {
        Subject subject = new CacheProxy(new RealSubject());
        String operation1 = subject.operation(); // μ²μλ§ 1μ΄ μ†μ”
        String operation2 = subject.operation(); // μ΄ν›„λ¶€ν„° μΊμ‹λ λ°μ΄ν„° μ΅°ν
        String operation3 = subject.operation(); // μ΄ν›„λ¶€ν„° μΊμ‹λ λ°μ΄ν„° μ΅°ν
        String operation4 = subject.operation(); // μ΄ν›„λ¶€ν„° μΊμ‹λ λ°μ΄ν„° μ΅°ν
        System.out.println("operation1 = " + operation1);
        System.out.println("operation2 = " + operation2);
        System.out.println("operation3 = " + operation3);
        System.out.println("operation4 = " + operation4);
    }
}
```

# π’΅ μ¥λ‹¨μ 

### μ¥μ 

- κ°λ°© νμ‡„ μ›μΉ™(OCP) μ¤€μ -> κΈ°μ΅΄ λ€μƒ κ°μ²΄μ μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³  μƒλ΅μ΄ κΈ°λ¥μ„ μ¶”κ°€ν•  μ μλ‹¤.
- λ‹¨μΌ μ±…μ„ μ›μΉ™(SRP) μ¤€μΒ -> λ€μƒ κ°μ²΄λ” μμ‹ μ κΈ°λ¥μ—λ§ μ§‘μ¤‘ ν•κ³ , κ·Έ μ΄μ™Έ λ¶€κ°€ κΈ°λ¥μ„ μ κ³µν•λ” μ—­ν• μ„ ν”„λ΅μ‹ κ°μ²΄μ— μ„μ„ν•μ—¬ λ‹¤μ¤‘ μ±…μ„μ„ νν”Ό ν•  μ μλ‹¤.
- μ›λ ν•λ ¤λ κΈ°λ¥μ„ μν–‰ν•λ©° κ·Έμ™Έμ λ¶€κ°€μ μΈ μ‘μ—…(λ΅κΉ…, μΈμ¦, λ„¤νΈμ›ν¬ ν†µμ‹  λ“±)μ„ μν–‰ν•λ”λ° μ μ©ν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈλ” κ°μ²΄λ¥Ό μ‹ κ²½μ“°μ§€ μ•κ³ , μ„λΉ„μ¤ κ°μ²΄λ¥Ό μ μ–΄ν•κ±°λ‚ μƒλ… μ£ΌκΈ°λ¥Ό κ΄€λ¦¬ν•  μ μλ‹¤.
- μ‚¬μ©μ μ…μ¥μ—μ„λ” ν”„λ΅μ‹ κ°μ²΄λ‚ μ‹¤μ  κ°μ²΄λ‚ μ‚¬μ©λ²•μ€ μ μ‚¬ν•λ―€λ΅ μ‚¬μ©μ„±μ— λ¬Έμ  λμ§€ μ•λ”λ‹¤.

### λ‹¨μ 

- λ§μ€ ν”„λ΅μ‹ ν΄λμ¤λ¥Ό λ„μ…ν•΄μ•Ό ν•λ―€λ΅ μ½”λ“μ λ³µμ΅λ„κ°€ μ¦κ°€ν•λ‹¤.
  - μλ¥Όλ“¤μ–΄ μ—¬λ¬ ν΄λμ¤μ— λ΅κΉ… κΈ°λ¥μ„ κ°€λ―Έ μ‹ν‚¤κ³  μ‹¶λ‹¤λ©΄, λ™μΌν• μ½”λ“λ¥Ό μ μ©ν•¨μ—λ„ κ°κ°μ ν΄λμ¤μ— ν•΄λ‹Ήλλ” ν”„λ΅μ‹ ν΄λμ¤λ¥Ό λ§λ“¤μ–΄μ„ μ μ©ν•΄μ•Ό λκΈ° λ•λ¬Έμ— μ½”λ“λ‰μ΄ λ§μ•„μ§€κ³  μ¤‘λ³µμ΄ λ°μƒ λλ‹¤.
  - μλ°”μ—μ„λ” λ™μ  ν”„λ΅μ‹(Dynamic Proxy) κΈ°λ²•μ„ μ΄μ©ν•΄μ„ ν•΄κ²°ν•  μ μλ‹¤.
- ν”„λ΅μ‹ ν΄λμ¤ μμ²΄μ— λ“¤μ–΄κ°€λ” μμ›μ΄ λ§λ‹¤λ©΄ μ„λΉ„μ¤λ΅λ¶€ν„°μ μ‘λ‹µμ΄ λ¦μ–΄μ§ μ μλ‹¤.
