# 💡 Index Range Scan

- 인덱스 레인지 스캔은 인덱스를 범위 기준으로 스캔하는 방식이다.
- SQL문에서 BETWEEN ~ AND 구문이나, >, <, LIKE 구문 등 비교 연산에서 인덱스 레인지 스캔이 수행된다.

```sql
SELECT * FROM employees WHERE first_name BETWEEN 'Ebbe' AND 'Gad';
```

![image](https://github.com/user-attachments/assets/02d00434-3be4-48f2-bbdf-bc7d2ac5170d)

- 루트 노드 -> 브랜치 노드 -> 리프 노드를 탐색해 시작지점을 확인한다.
- 리프 노드의 시작지점부터 끝지점까지 리프 노드 간의 링크를 통해 범위 스캔한다.
- 보통 인덱스 탐색이 완료되면 실제 데이터 파일의 레코드를 읽어와야 한다. 그 과정은 아래 이미지와 같다.

![image](https://github.com/user-attachments/assets/f2882e58-cf0f-4f78-a1d9-7158da3ce347)

- 인덱스는 정렬되어 있기 때문에 인덱스 컬럼의 정순 또는 역순으로 레코드 주소를 가져온다.
- 레코드 주소를 통해 데이터 파일에서 레코드를 읽어 오는데, 이 때 랜덤I/O가 발생하게 된다.
- 참고) 커버링 인덱스로 처리되는 쿼리는 디스크를 읽지 않아 랜덤I/O자체가 없어져 성능이 빨라진다.

# 💡 Index Full Scan

- 인덱스 풀 스캔은 인덱스를 처음부터 끝까지 모두 읽는 방식이다.
- 단, 테이블에 접근하지 않고 인덱스로 구성된 컬럼 정보만 요구하는 쿼리에서 인덱스 풀 스캔이 수행된다. 인덱스뿐만 아니라 데이터 레코드까지 모두 읽어야 한다면 절대 이 방식으로 처리되지 않는다.
- 쿼리의 조건절에 사용된 컬럼이 인덱스의 첫 번째 컬럼이 아닐 경우 인덱스 풀 스캔이 수행된다.
  - 예를 들어, index(A, B, C)로 인덱스가 생성되어 있을 때, 쿼리의 조건절에서 B 또는 C 컬럼으로 검색하는 경우
  - SELECT * FROM employees WHERE B = 'b' AND C = 'c';

![image](https://github.com/user-attachments/assets/365a5093-a837-409f-bfba-48d2cd895a32)

- 인덱스 리프 노드의 제일 처음 또는 맨 끝으로 이동한 후, 리프 노드를 연결하는 Linked-list를 따라 전체를 스캔한다.
- 인덱스에 포함된 컬럼만으로 쿼리를 처리할 수 있는 경우 Table Full Scan 할 필요가 없어 사용되는 방식이다.
- Table Full Scan 방식보다는 빠르지만, 인덱스라는 오브젝트 전 영역을 모두 검색하는 방식이므로 검색 범위를 최대한 줄이는 방향으로 튜닝해야 한다.

# 💡 Index Loose Scan

- 인덱스 루스 스캔은 인덱스의 필요한 부분들만 골라 스캔하는 방식이다.
- 인덱스 레인지 스캔과 비슷하게 동작하지만, 중간에 필요 없는 인덱스 키는 무시한다.
- 일반적으로 `GROUP BY` 구문이나 `MIN`, `MAX` 함수가 포함된 경우 인덱스 루스 스캔으로 동작한다.

```sql
SELECT dept_no, MIN(emp_no)
FROM dept_emp
WHERE dept_no BETWEEN 'd002' AND 'd004'
GROUP BY dept_no;
```

- dept_emp 테이블의 인덱스가 (dept_no, emp_no)로 설정되어 있다고 하자.
- 옵티마이저는 dept_no 중에서 마지막 emp_no만 알면 되므로 다른 emp_no는 무시하게 된다.
- 이런 식으로 필요한 부분만 스캔하고 필요없는 키는 무시하는 방식이 인덱스 루스 스캔이다.

# 💡 Index Unique Scan

- 인덱스 고유 스캔은 기본 키나 고유 인덱스로 테이블에 접근하는 방식이다.
- 인덱스 스캔 방식 중 가장 효율적인 방법이다.
- WHERE 절에 = 조건으로 작성하며, 멀티 컬럼 인덱스일 경우 조건 컬럼이 선두 컬럼일 경우에 동작한다.

# 💡 Index Merge Scan

- 인덱스 병합 스캔은 테이블 내에 생성된 인덱스들을 통합해서 스캔하는 방식이다.
- WHERE문의 조건 컬럼들이 서로 다른 인덱스에 존재할 때 사용된다.
- 물리적으로 존재하는 개별 인덱스를 각각 수행하므로 인덱스에 접근하는 시간이 오래 걸린다.
- 따라서, 별개로 수행되는 인덱스를 하나의 인덱스로 통합하여 튜닝한다.

# References

- [책] RealMySQL8.0
- [책] 업무에 바로 쓰는 SQL 튜닝
