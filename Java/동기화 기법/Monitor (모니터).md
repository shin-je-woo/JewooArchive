# Previous

- 자바가 동기화를 지원하기 위해 사용하는 메커니즘은 모니터(Monitor) 이며 뮤텍스나 세마포어보다 더 고수준의 동기화 기법이다.
- 모든 자바 객체는 기본적으로 모니터를 가지며 여러 스레드가 객체의 임계 영역(critical section)에 진입하려고 할 때 JVM 은 모니터를 사용하여 스레드 간 동기화를 제공한다.
- 자바의 모니터는 상호 배제(Mutual Exclusion) 및 협력(Cooperation)이라는 두 가지 동기화 기능을 제공하고 있으며 이를 위해 뮤텍스와 조건변수(Condition Variable)를 사용한다.

# 💡 상호 배제 (Mutual Exclusion)

- 객체가 가지고 있는 모니터 Lock 을 통해 여러 스레드가 동시에 공유 자원에 접근하는 것을 막아 데이터의 일관성과 안전성을 보장하는 메커니즘이다.
- JVM 은 `synchronized` 키워드를 이용하여 뮤텍스 동기화를 암묵적으로 처리해 주고 있으며 synchronized 는 메서드나 코드 블록에 적용할 수 있다.
- **synchronized (동기화)**
  - synchronized 블록은 해당 객체의 모니터를 획득 할 수 있으며 모니터를 획득한 스레드만이 임계영역에 접근 가능하고 그 외 다른 스레드들은 차단되어 대기 상태가 된다.
  - synchronized 블록을 빠져 나오면 모니터 Lock 이 해제되고 대기 중인 다른 스레드 중 하나가 락을 얻고 임계 영역에 진입하여 작업을 수행하는 식으로 상호배제가 보장된다.
 
# 💡 협력 (Cooperation)

- 협력은 모니터의 Condition Variable (조건 변수) 를 통해 스레드 간 공동의 목표를 위해 상호협력으로 데이터의 일관성과 안전성을 보장하는 동기화 메커니즘이다.
- **Condition Variable (조건변수)**
  - 조건변수는 Object 클래스의 메소드인 wait(), notify(), notifyAll()과 함께 작용하며 특정 조건이 만족될 때까지 스레드를 대기시키는 기능을 제공한다.
  - 스레드가 특정 조건에 부합하지 않을 때 wait() 메소드를 호출하면 조건변수의 대기 셋(Wait Set)에 들어가 대기한다.
  - 다른 스레드가 특정 조건을 만족해서 notify() 또는 notifyAll() 메소드를 호출하면 해당 조건변수의 대기셋으로부터 스레드들을 깨워 실행시키게 된다.
- 조건변수를 통해 스레드 간 대기와 통지를 서로 조절하면서 경쟁 조건(race condition)과 같은 문제를 방지할 수 있다.
- 모니터 내부에는 여러개의 조건 변수를 가질 수 있지만 자바의 모니터에는 오직 한 개의 조건 변수만 가질 수 있다.
