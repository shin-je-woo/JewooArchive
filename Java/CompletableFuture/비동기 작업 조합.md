# ğŸ’¡ thenCompose[Async](Function<T, CompletionStage<U>> fn)

- ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œë¡œì„œ (ë¹„)ë™ê¸°ì ìœ¼ë¡œ í•˜ë‚˜ì˜ CompletableFuture ê°€ ì™„ë£Œë˜ë©´ ê·¸ ê²°ê³¼ë¥¼ ë‹¤ìŒ ì‘ì—…ìœ¼ë¡œ ì „ë‹¬í•˜ê³  ì´ì–´ì„œ ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ ì¤€ë‹¤. ì´ë¥¼ í†µí•´ ì—¬ëŸ¬ ë¹„ë™ê¸° ì‘ì—…ì„ ì—°ì†ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê³  ì¡°í•©í•  ìˆ˜ ìˆë‹¤.
- `Function<T, CompletionStage<U>>` í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ë°›ê³  ì‘ì—… ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.
- ìƒˆë¡œìš´ `CompletableFuture<T>` ê°ì²´ë¥¼ ë°˜í™˜í•˜ë©° CompletableFuture ì— ì‘ì—… ê²°ê³¼ë¥¼ ì €ì¥í•œë‹¤.
- ì‹¤í–‰ ê°ì²´ëŠ” `UniCompose` ì´ë‹¤. (CompletableFuture ë‚´ë¶€í´ë˜ìŠ¤)

### ì˜ˆì œ ì½”ë“œ

```java
void thenCompose() throws ExecutionException, InterruptedException {
    CompletableFuture<String> hello = CompletableFuture.supplyAsync(() -> {
        return "Hello";
    });

    // Future ê°„ì— ì—°ê´€ ê´€ê³„ê°€ ìˆëŠ” ê²½ìš°
    CompletableFuture<String> future = hello.thenCompose(this::world);
    System.out.println(future.get()); // Hello Wolrd ì¶œë ¥
}

private CompletableFuture<String> world(String message) {
    return CompletableFuture.supplyAsync(() -> {
        return message + " " + "World";
    });
}
```

### thenCompose\[Async\]() íë¦„ë„

![image](https://github.com/shin-je-woo/TIL/assets/39439576/1aee48dc-7a7d-4607-baa1-ccb70fc81665)

# ğŸ’¡ thenCombine[Async](CompletionStage<U> other, BiFunction<T, U, V> fn)

- ë‘ ê°œì˜ CompletableFuture ê°€ ëª¨ë‘ ì™„ë£Œë˜ì—ˆì„ ë•Œ íŠ¹ì • í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ CompletableFuture ì— ì €ì¥í•˜ê³  ë°˜í™˜í•œë‹¤.
- `CompletionStage<U>` , `BiFunction<T, U, V>` í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ë°›ê³  ìµœì¢… ì‘ì—… ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.
- ìƒˆë¡œìš´ `CompletableFuture<T>` ê°ì²´ë¥¼ ë°˜í™˜í•˜ë©° CompletableFuture ì— ì‘ì—… ê²°ê³¼ë¥¼ ì €ì¥í•œë‹¤.

### ì˜ˆì œ ì½”ë“œ

```java
void thenCombine() throws ExecutionException, InterruptedException {
    CompletableFuture<String> hello = CompletableFuture.supplyAsync(() -> {
        return "Hello";
    });

    CompletableFuture<String> world = CompletableFuture.supplyAsync(() -> {
        return "World";
    });

    CompletableFuture<String> future = hello.thenCombine(world, (h, w) -> h + " " + w);
    System.out.println(future.get()); // Hello Wolrd ì¶œë ¥
}
```

### thenCompose\[Async\]() íë¦„ë„

![image](https://github.com/shin-je-woo/TIL/assets/39439576/46f71deb-c0b6-42eb-84d4-bdfde32ec781)

# ğŸ’¡ allOf(CompletableFuture<?>... cfs)

- ì—¬ëŸ¬ ê°œì˜ CompletableFutureë¥¼ ë™ì‹œì— ì‹¤í–‰í•˜ê³  ëª¨ë“  CompletableFutureê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.
- CompletableFuture ì¤‘ì—ì„œ ê°€ì¥ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì‘ì—…ì´ ì™„ë£Œ ë˜ê¸° ì „ ê¹Œì§€ allOf() ëŠ” ëŒ€ê¸°í•œë‹¤.
- ExecutorService ì˜ invokeAll() ê³¼ ìœ ì‚¬í•œ ê°œë…ì´ë‹¤.
- `CompletableFuture<?>` ì˜ ë°°ì—´ì„ ì¸ìˆ˜ë¡œ ë°›ëŠ”ë‹¤.
- ìƒˆë¡œìš´ `CompletableFuture<Void>` ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.

### ì˜ˆì œ ì½”ë“œ

```java
void allOf() throws ExecutionException, InterruptedException {
    CompletableFuture<String> hello = CompletableFuture.supplyAsync(() -> {
        return "Hello";
    });

    CompletableFuture<String> world = CompletableFuture.supplyAsync(() -> {
        return "World";
    });

    List<CompletableFuture<String>> futures = List.of(hello, world);

    CompletableFuture<List<String>> result = CompletableFuture.allOf(futures.toArray(new CompletableFuture[futures.size()]))
            .thenApply(v -> futures.stream().
                    map(CompletableFuture::join).
                    collect(Collectors.toList()));

    result.get().forEach(System.out::println);
}
```

### allOf(CompletableFuture\<?\>... cfs) íë¦„ë„

![image](https://github.com/shin-je-woo/TIL/assets/39439576/6e419ec1-0487-4625-b100-0ca6722b7b1c)

# ğŸ’¡ anyOf(CompletableFuture<?>... cfs)

- ì—¬ëŸ¬ ê°œì˜ CompletableFuture ì¤‘ì—ì„œ ê°€ì¥ ë¨¼ì € ì™„ë£Œë˜ëŠ” í•˜ë‚˜ì˜ CompletableFutureë¥¼ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œì´ë‹¤.
- ë³‘ë ¬ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³  ê°€ì¥ ë¨¼ì € ë°˜í™˜ë˜ëŠ” ê²°ê³¼ë¥¼ ì–»ê³ ì í•  ë•Œ ìœ ìš©í•˜ë‹¤.
- ExecutorService ì˜ invokeAny() ê³¼ ìœ ì‚¬í•œ ê°œë…ì´ë‹¤.
- `CompletableFuture<?>` ì˜ ë°°ì—´ì„ ì¸ìˆ˜ë¡œ ë°›ëŠ”ë‹¤.
- ìƒˆë¡œìš´ `CompletableFuture<Object>` ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.

### ì˜ˆì œ ì½”ë“œ

```java
void anyOf() throws ExecutionException, InterruptedException {
    CompletableFuture<String> hello = CompletableFuture.supplyAsync(() -> {
        try {
            Thread.sleep(1000L);
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }

        return "Hello";
    });

    CompletableFuture<String> world = CompletableFuture.supplyAsync(() -> {
        return "World";
    });

    CompletableFuture<Void> future = CompletableFuture.anyOf(hello, world).thenAccept(System.out::println);
    future.get();
}
```

### anyOf(CompletableFuture\<?\>... cfs) íë¦„ë„

![image](https://github.com/shin-je-woo/TIL/assets/39439576/1ad3e8e8-298c-42da-8bd4-1bafe93fcc21)
