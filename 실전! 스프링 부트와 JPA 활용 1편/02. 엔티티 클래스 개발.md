# ğŸ’¡ ì—”í‹°í‹° í´ë˜ìŠ¤ ì„¤ê³„
* ì˜ˆì œì—ì„œëŠ” ì„¤ëª…ì„ ì‰½ê²Œí•˜ê¸° ìœ„í•´ ì—”í‹°í‹° í´ë˜ìŠ¤ì— Getter, Setterë¥¼ ëª¨ë‘ ì—´ê³ , ìµœëŒ€í•œ ë‹¨ìˆœí•˜ê²Œ ì„¤ê³„
* ì‹¤ë¬´ì—ì„œëŠ” ê°€ê¸‰ì  GetterëŠ” ì—´ì–´ë‘ê³ , SetterëŠ” ê¼­ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œ

> ì°¸ê³   
> ì´ë¡ ì ìœ¼ë¡œ Getter, Setter ëª¨ë‘ ì œê³µí•˜ì§€ ì•Šê³ , ê¼­ í•„ìš”í•œ ë³„ë„ì˜ ë©”ì„œë“œë¥¼ ì œê³µí•˜ëŠ”ê²Œ ê°€ì¥ ì´ìƒì ì´ë‹¤.  
> í•˜ì§€ë§Œ ì‹¤ë¬´ì—ì„œ ì—”í‹°í‹°ì˜ ë°ì´í„°ëŠ” ì¡°íšŒí•  ì¼ì´ ë„ˆë¬´ ë§ìœ¼ë¯€ë¡œ Getterì˜ ê²½ìš° ëª¨ë‘ ì—´ì–´ë‘ëŠ” ê²ƒì´ í¸ë¦¬í•˜ë‹¤.  
> GetterëŠ” ì•„ë¬´ë¦¬ í˜¸ì¶œí•´ë„ í˜¸ì¶œ í•˜ëŠ” ê²ƒ ë§Œìœ¼ë¡œ ì–´ë–¤ ì¼ì´ ë°œìƒí•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.  
> í•˜ì§€ë§ŒSetterëŠ” ë¬¸ì œê°€ ë‹¤ë¥´ë‹¤. Setterë¥¼ í˜¸ì¶œí•˜ë©´ ë°ì´í„°ê°€ ë³€í•œë‹¤.  
> Setterë¥¼ ë§‰ ì—´ì–´ë‘ë©´ ê°€ê¹Œìš´ ë¯¸ë˜ì— ì—”í‹°í‹°ì—ê°€ ë„ëŒ€ì²´ ì™œ ë³€ê²½ë˜ëŠ”ì§€ ì¶”ì í•˜ê¸° ì ì  í˜ë“¤ì–´ì§„ë‹¤.  
> ê·¸ë˜ì„œ ì—”í‹°í‹°ë¥¼ ë³€ê²½í•  ë•ŒëŠ” Setter ëŒ€ì‹ ì—  ë³€ê²½ ì§€ì ì´ ëª…í™•í•˜ë„ë¡ ë³€ê²½ì„ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œë¥¼ ë³„ë„ë¡œ ì œê³µí•´ì•¼ í•œë‹¤.

![image](https://user-images.githubusercontent.com/39439576/234289775-51ef43cf-c5da-4861-b0a3-84d6990060be.png)

â–¶ï¸ íšŒì›(Member) ì—”í‹°í‹°
```java
@Entity
@Getter @Setter
public class Member {
    @Id @GeneratedValue
    @Column(name = "member_id") 
    private Long id;

    private String name;

    @Embedded
    private Address address;

    @OneToMany(mappedBy = "member")
    private List<Order> orders = new ArrayList<>();
}
```

â–¶ï¸ ì£¼ë¬¸(Order) ì—”í‹°í‹°
```java
@Entity
@Table(name = "orders")
@Getter @Setter
public class Order {
    @Id @GeneratedValue
    @Column(name = "order_id")
    private Long id;
    
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "member_id")
    private Member member; //ì£¼ë¬¸ íšŒì›
    
    @OneToMany(mappedBy = "order", cascade = CascadeType.ALL)
    private List<OrderItem> orderItems = new ArrayList<>();
    
    @OneToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    @JoinColumn(name = "delivery_id")
    private Delivery delivery; //ë°°ì†¡ì •ë³´
    
    private LocalDateTime orderDate; //ì£¼ë¬¸ì‹œê°„
    
    @Enumerated(EnumType.STRING)
    private OrderStatus status; //ì£¼ë¬¸ìƒíƒœ [ORDER, CANCEL]
    
    //==ì—°ê´€ê´€ê³„ ë©”ì„œë“œ==//
    public void setMember(Member member) {
        this.member = member;
        member.getOrders().add(this);
    }
    
    public void addOrderItem(OrderItem orderItem) {
        orderItems.add(orderItem);
        orderItem.setOrder(this);
    }
    
    public void setDelivery(Delivery delivery) {
        this.delivery = delivery;
        delivery.setOrder(this);
    }
}
```

â–¶ï¸ ì£¼ë¬¸ìƒí’ˆ(OrderItem)ì—”í‹°í‹°
```java
@Entity
@Table(name = "order_item")
@Getter @Setter
public class OrderItem {
    @Id @GeneratedValue
    @Column(name = "order_item_id")
    private Long id;
    
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "item_id")
    private Item item; //ìƒí’ˆ
    
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "order_id")
    private Order order; //ì£¼ë¬¸
    
    private int orderPrice; //ì£¼ë¬¸ ê°€ê²©
    
    private int count; //ì£¼ë¬¸ ìˆ˜ëŸ‰
}
```

â–¶ï¸ ìƒí’ˆ(Item) ì—”í‹°í‹°
```java
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "dtype")
@Getter @Setter
public abstract class Item {
    @Id @GeneratedValue
    @Column(name = "item_id")
    private Long id;

    private String name;

    private int price;

    private int stockQuantity;

    @ManyToMany(mappedBy = "items")
    private List<Category> categories = new ArrayList<Category>();
}
```

â–¶ï¸ ìƒí’ˆ - ë„ì„œ ì—”í‹°í‹°
```java
@Entity
@DiscriminatorValue("B")
@Getter @Setter
public class Book extends Item {
    private String author;
    private String isbn;
}
```

â–¶ï¸ ìƒí’ˆ - ìŒë°˜ ì—”í‹°í‹°
```java
@Entity
@DiscriminatorValue("A")
@Getter @Setter
public class Album extends Item {
    private String artist;
    private String etc;
}
```

â–¶ï¸ ìƒí’ˆ - ì˜í™” ì—”í‹°í‹°
```java
@Entity
@DiscriminatorValue("M")
@Getter @Setter
public class Movie extends Item {
    private String director;
    private String actor;
}
```

â–¶ï¸ ë°°ì†¡(Delivery)ì—”í‹°í‹°
```java
@Entity
@Getter @Setter
public class Delivery {
    @Id @GeneratedValue
    @Column(name = "delivery_id")
    private Long id;
    
    @OneToOne(mappedBy = "delivery", fetch = FetchType.LAZY)
    private Order order;
    
    @Embedded
    private Address address;
    
    @Enumerated(EnumType.STRING)
    private DeliveryStatus status; //ENUM [READY(ì¤€ë¹„), COMP(ë°°ì†¡)]
}
```

â–¶ï¸ ì¹´í…Œê³ ë¦¬(Category) ì—”í‹°í‹°
```java
@Entity
@Getter @Setter
public class Category {
    @Id @GeneratedValue
    @Column(name = "category_id")
    private Long id;
    
    private String name;
    
    @ManyToMany
    @JoinTable(name = "category_item",
            joinColumns = @JoinColumn(name = "category_id"),
            inverseJoinColumns = @JoinColumn(name = "item_id"))
    private List<Item> items = new ArrayList<>();
    
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "parent_id")
    private Category parent;
    
    @OneToMany(mappedBy = "parent")
    private List<Category> child = new ArrayList<>();
    
    //==ì—°ê´€ê´€ê³„ ë©”ì„œë“œ==//
    public void addChildCategory(Category child) {
        this.child.add(child);
        child.setParent(this);
    }
}
```

> ğŸ“Œ ì°¸ê³ : ì‹¤ë¬´ì—ì„œëŠ” @ManyToMany ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ì  
> @ManyToMany ëŠ” í¸ë¦¬í•œ ê²ƒ ê°™ì§€ë§Œ, ì¤‘ê°„ í…Œì´ë¸”( CATEGORY_ITEM )ì— ì»¬ëŸ¼ì„ ì¶”ê°€í•  ìˆ˜ ì—†ê³ ,  
>  ì„¸ë°€í•˜ê²Œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê¸° ì–´ë µê¸° ë•Œë¬¸ì— ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•˜ê¸°ì—ëŠ” í•œê³„ê°€ ìˆë‹¤.  
>  ì¤‘ê°„ ì—”í‹°í‹°( CategoryItem) ë¥¼ ë§Œë“¤ê³  @ManyToOne , @OneToMany ë¡œ ë§¤í•‘í•´ì„œ ì‚¬ìš©í•˜ì.  
>  ì •ë¦¬í•˜ë©´ ëŒ€ë‹¤ëŒ€ ë§¤í•‘ì„ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ë§¤í•‘ìœ¼ë¡œ í’€ì–´ë‚´ì„œ ì‚¬ìš©í•˜ì.

â–¶ï¸ ì£¼ì†Œ(Address) ê°’ íƒ€ì…(ì„ë² ë””ë“œ íƒ€ì…)
```java
@Embeddable
@Getter
public class Address {
    private String city;
    private String street;
    private String zipcode;
    
    protected Address() {}
    
    public Address(String city, String street, String zipcode) {
        this.city = city;
        this.street = street;
        this.zipcode = zipcode;
    }
}
```

> ğŸ“Œ ì°¸ê³ : ê°’ íƒ€ì…ì€ ë³€ê²½ ë¶ˆê°€ëŠ¥í•˜ê²Œ ì„¤ê³„í•´ì•¼ í•œë‹¤.  
> @Setter ë¥¼ ì œê±°í•˜ê³ , ìƒì„±ìì—ì„œ ê°’ì„ ëª¨ë‘ ì´ˆê¸°í™”í•´ì„œ ë³€ê²½ ë¶ˆê°€ëŠ¥í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì.  
> JPA ìŠ¤í™ìƒ ì—”í‹°í‹°ë‚˜ ì„ë² ë””ë“œ íƒ€ì…( @Embeddable )ì€ ìë°” ê¸°ë³¸ ìƒì„±ì(default constructor)ë¥¼ public ë˜ëŠ” protected ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤. 
>  public ìœ¼ë¡œ ë‘ëŠ” ê²ƒ ë³´ë‹¤ëŠ” protected ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ê·¸ë‚˜ë§ˆ ë” ì•ˆì „í•˜ë‹¤.    
> JPAê°€ ì´ëŸ° ì œì•½ì„ ë‘ëŠ” ì´ìœ ëŠ” JPA êµ¬í˜„ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ë¦¬í”Œë ‰ì…˜ ê°™ì€ ê¸°ìˆ ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

# ğŸ’¡ ì—”í‹°í‹° ì„¤ê³„ì‹œ ì£¼ì˜ì 
* **ì—”í‹°í‹°ì—ì„œëŠ” ê°€ê¸‰ì  Setterë¥¼ ì‚¬ìš©í•˜ì§€ ë§ì.**
  * Setterê°€ ì—´ë ¤ìˆìœ¼ë©´ ë³€ê²½ í¬ì¸íŠ¸ê°€ ë„ˆë¬´ ë§ì•„ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë µë‹¤.
* **ëª¨ë“  ì—°ê´€ê´€ê³„ëŠ” ì§€ì—°ë¡œë”©ìœ¼ë¡œ ì„¤ì •!**
  * ì¦‰ì‹œë¡œë”©( EAGER )ì€ ì˜ˆì¸¡ì´ ì–´ë µê³ , ì–´ë–¤ SQLì´ ì‹¤í–‰ë ì§€ ì¶”ì í•˜ê¸° ì–´ë µë‹¤. 
  * íŠ¹íˆ JPQLì„ ì‹¤í–‰í•  ë•Œ N+1 ë¬¸ì œê°€ ìì£¼ ë°œìƒí•œë‹¤.
  * ì‹¤ë¬´ì—ì„œ ëª¨ë“  ì—°ê´€ê´€ê³„ëŠ” ì§€ì—°ë¡œë”©( LAZY )ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.
  * ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ í•¨ê»˜ DBì—ì„œ ì¡°íšŒí•´ì•¼ í•˜ë©´, fetch join ë˜ëŠ” ì—”í‹°í‹° ê·¸ë˜í”„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.
  * @XToOne(OneToOne, ManyToOne) ê´€ê³„ëŠ” ê¸°ë³¸ì´ ì¦‰ì‹œë¡œë”©ì´ë¯€ë¡œ ì§ì ‘ ì§€ì—°ë¡œë”©ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤. 
* **ì»¬ë ‰ì…˜ì€ í•„ë“œì—ì„œ ì´ˆê¸°í™” í•˜ì.**
  * ì»¬ë ‰ì…˜ì€ í•„ë“œì—ì„œ ë°”ë¡œ ì´ˆê¸°í™” í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤. null ë¬¸ì œì—ì„œ ì•ˆì „í•˜ë‹¤.
  * í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ì—”í‹°í‹°ë¥¼ ì˜ì†í™” í•  ë•Œ, ì»¬ë™ì…˜ì„ ê°ì‹¸ì„œ í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì œê³µí•˜ëŠ” ë‚´ì¥ ì»¬ë ‰ì…˜ìœ¼ë¡œ ë³€ê²½í•œë‹¤. 
  * ë§Œì•½ getOrders() ì²˜ëŸ¼ ì„ì˜ì˜ ë©”ì„œë“œì—ì„œ ì»¬ë ¥ì…˜ì„ ì˜ëª» ìƒì„±í•˜ë©´ í•˜ì´ë²„ë„¤ì´íŠ¸ ë‚´ë¶€ ë©”ì»¤ë‹ˆì¦˜ì— ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. 
  * ë”°ë¼ì„œ í•„ë“œë ˆë²¨ì—ì„œ ìƒì„±í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì•ˆì „í•˜ê³ , ì½”ë“œë„ ê°„ê²°í•˜ë‹¤.
