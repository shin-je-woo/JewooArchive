# ğŸ’¡  ìˆœìˆ˜ JPA ë¦¬í¬ì§€í† ë¦¬ì™€ Querydsl
â–¶ï¸ ì½”ë“œ ë¹„êµ
```java
public List<Member> findAll() {
    return em.createQuery("select m from Member m", Member.class)
            .getResultList();
}

// ìœ„ì˜ JPA ì½”ë“œëŠ” ì¿¼ë¦¬ë¬¸ì„ ì§ì ‘ ì¨ì•¼í•˜ëŠ”ë° Querydslì„ ì‚¬ìš©í•˜ë©´ ìë°”ë¡œ ì‘ì„±í•  ìˆ˜ ìˆìŒ
public List<Member> findAll_Querydsl() {
    return queryFactory
            .selectFrom(member)
            .fetch();
}

public List<Member> findByUsername(String username) {
    return em.createQuery("select m from Member m where m.username = :username", Member.class)
            .setParameter("username", username)
            .getResultList();
}

public List<Member> findByUsername_Querydsl(String username) {
    return queryFactory
            .selectFrom(member)
            .where(member.username.eq(username))
            .fetch();
}
```
### JPAQueryFactory ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡
- ë‹¤ìŒê³¼ ê°™ì´ JPAQueryFactory ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì„œ ì£¼ì…ë°›ì•„ ì‚¬ìš©í•´ë„ ëœë‹¤.
```java
@Bean
JPAQueryFactory jpaQueryFactory(EntityManager em) {
    return new JPAQueryFactory(em);
}
```
> ì°¸ê³ 
> ì´ ë°©ì‹ì—ì„œ ë™ì‹œì„± ë¬¸ì œëŠ” ê±±ì •í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.   
> ì—¬ê¸°ì„œ ìŠ¤í”„ë§ì´ ì£¼ì…í•´ì£¼ëŠ” ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” í”„ë¡ì‹œ ì—”í‹°í‹° ë§¤ë‹ˆì €ì´ë‹¤.  
> ì´ ê°€ì§œ ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ì‹¤ì œì‚¬ìš© ì‹œì ì— íŠ¸ëœì­ì…˜ ë‹¨ìœ„ë¡œ ì‹¤ì œ ì—”í‹°í‹° ë§¤ë‹ˆì €(ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸)ë¥¼ í• ë‹¹í•´ì¤€ë‹¤.

# ğŸ’¡ ë™ì  ì¿¼ë¦¬ì™€ ì„±ëŠ¥ ìµœì í™” ì¡°íšŒ - BooleanBuilder ì‚¬ìš©
â–¶ï¸ MemberTeamDto - ì¡°íšŒ ìµœì í™”ìš© DTO
```java
@Data
public class MemberTeamDto {
    private Long memberId;
    private String username;
    private int age;
    private Long teamId;
    private String teamName;

    @QueryProjection
    public MemberTeamDto(Long memberId, String username, int age, Long teamId, String teamName) {
        this.memberId = memberId;
        this.username = username;
        this.age = age;
        this.teamId = teamId;
        this.teamName = teamName;
    }
}
```
- ì°¸ê³ ) @QueryProjection ì„ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ DTOê°€ Querydslì„ ì˜ì¡´í•˜ê²Œ ëœë‹¤.
- ì´ëŸ° ì˜ì¡´ì´ ì‹«ìœ¼ë©´ í•´ë‹¹ ì—ë…¸í…Œì´ì…˜ì„ ì œê±°í•˜ê³ , `Projection.bean(), fields(), constructor()` ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

â–¶ï¸ íšŒì› ê²€ìƒ‰ ì¡°ê±´ 
```java
@Data
public class MemberSearchCondition {
    // íšŒì›ëª…, íŒ€ëª…, ë‚˜ì´(ageGoe, ageLoe)
    private String username;
    private String teamName;
    private Integer ageGoe;
    private Integer ageLoe;
}
```

â–¶ï¸ BooleanBuilderë¥¼ ì‚¬ìš©í•œ ì˜ˆì œ
```java
public List<MemberTeamDto> searchByBuilder(MemberSearchCondition condition) {
    BooleanBuilder builder = new BooleanBuilder();

    if (hasText(condition.getUsername())) {
        builder.and(member.username.eq(condition.getUsername()));
    }
    if (hasText(condition.getTeamName())) {
        builder.and(team.name.eq(condition.getTeamName()));
    }
    if (condition.getAgeGoe() != null) {
        builder.and(member.age.goe(condition.getAgeGoe()));
    }
    if (condition.getAgeLoe() != null) {
        builder.and(member.age.loe(condition.getAgeLoe()));
    }

    return queryFactory
            .select(new QMemberTeamDto(
                    member.id.as("memberId"),
                    member.username,
                    member.age,
                    team.id.as("teamId"),
                    team.name.as("teamName")
            ))
            .from(member)
            .leftJoin(member.team, team)
            .where(builder)
            .fetch();
}
```
- ì°¸ê³ ë¡œ, `member.id.as("memberId")` ë¼ê³  ì ì—ˆëŠ”ë°, `QMemberTeamDto(@QueryProjection)` ëŠ” ìƒì„±ìë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— í•„ë“œ ì´ë¦„ì„ ë§ì¶”ì§€ ì•Šì•„ë„ ëœë‹¤.
- ë”°ë¼ì„œ `member.id` ë§Œ ì ì–´ë„ ëœë‹¤.

# ğŸ’¡ ë™ì  ì¿¼ë¦¬ì™€ ì„±ëŠ¥ ìµœì í™” ì¡°íšŒ - Whereì ˆ íŒŒë¼ë¯¸í„° ì‚¬ìš©
```java
public List<MemberTeamDto> search(MemberSearchCondition condition) {
    return queryFactory
            .select(new QMemberTeamDto(
                    member.id.as("memberId"),
                    member.username,
                    member.age,
                    team.id.as("teamId"),
                    team.name.as("teamName")
            ))
            .from(member)
            .leftJoin(member.team, team)
            .where(
                    usernameEq(condition.getUsername()),
                    teamNameEq(condition.getTeamName()),
                    ageGoe(condition.getAgeGoe()),
                    ageLoe(condition.getAgeLoe())
            )
            .fetch();
}

private BooleanExpression usernameEq(String username) {
    return hasText(username) ? member.username.eq(username) : null;
}

private BooleanExpression teamNameEq(String teamName) {
    return hasText(teamName) ? team.name.eq(teamName) : null;
}

private BooleanExpression ageGoe(Integer ageGoe) {
    return ageGoe != null ? member.age.goe(ageGoe) : null;
}

private BooleanExpression ageLoe(Integer ageLoe) {
    return ageLoe != null ? member.age.loe(ageLoe) : null;
}
```
- where ì ˆì— íŒŒë¼ë¯¸í„° ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ì¡°ê±´(usernameEq, teamNameEq, ageGoe, ageLoe..)ë“¤ì´ ì¬ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
